JWT (JSON Web Token) — стандарт (RFC 7519) для компактного и безопасного обмена информацией между сторонами. Основная идея — токен, который:

- подписан (или может быть зашифрован)
- содержит _claims_ — утверждения (например: кто пользователь, его роль, когда токен истёк и др.)
- может передаваться между клиентом и сервером, и сервер может проверить его валидность **без** хранения состояния сессии (stateless)

---

## Структура JWT

JWT состоит из трёх частей, разделённых точками (`.`):

1. **Header** (заголовок) — мета-информация. Обычно содержит:
   - `alg` — алгоритм подписи или шифрования (например, HS256, RS256)
   - `typ` — тип токена, часто `"JWT"`

2. **Payload** — полезная нагрузка, JSON-объект, где перечислены _claims_. В payload часто встречаются стандартные (зарегистрированные) claims:

   | Claim | Назначение                                                                                                        |
   | ----- | ----------------------------------------------------------------------------------------------------------------- |
   | `iss` | кто выпустил токен (issuer)                                                                                       |
   | `sub` | subject — для кого / для чего выпущен токен, часто userId                                                         |
   | `aud` | audience — кто должен принимать этот токен (например, API)                                                        |
   | `exp` | время истечения (expiration) — после этого момента токен считается недействительным                               |
   | `nbf` | “not before” — токен не действителен до указанного времени                                                        |
   | `iat` | “issued at” — когда токен был выдан                                                                               |
   | `jti` | уникальный идентификатор токена (JWT ID), может использоваться для ревокации / избежания повторного использования |

   Кроме стандартных, можно добавлять **кастомные claims** — например, роль пользователя, права доступа и др.

3. **Signature** (подпись) — обеспечивает, что header и payload не были изменены. Обычно создаётся так:

   ```
   signature = Sign( secretOrPrivateKey, Base64UrlEncode(header) + "." + Base64UrlEncode(payload) )
   ```

   Алгоритм зависит от `alg` в header.

---

## Процесс использования JWT

Вот как обычно JWT используются в системах аутентификации / авторизации:

1. Пользователь вводит логин/пароль → сервер проверяет.
2. Если всё хорошо, сервер **генерирует JWT**, подписывает его, включает нужные claims (например, `sub`, `exp`, роли).
3. JWT возвращается клиенту (в теле ответа или иногда как cookie).
4. Клиент хранит JWT (в зависимости от реализации).
5. При запросах к защищённым ресурсам клиент присылает JWT, обычно в HTTP-заголовке Authorization: Bearer `<token>`.
6. Сервер проверяет подпись, проверяет стандартные claims (exp, iat, etc.), проверяет, что токен не истёк и что “aud”/“iss” совпадают, если настроены. Если всё ОК → доступ даётся. Если нет → ошибка (401/403).

---

## Безопасность и возможные риски

- **Payload не шифруется по умолчанию** — его можно декодировать, поэтому не храните там секретную информацию.
- **Короткий срок жизни токена** (access-token) уменьшает ущерб, если токен украдут.
- **Ревокация / отзыв токена**: так как JWT “самодостаточный”, если он украден, то пока действует — его можно использовать; поэтому часто делают черный список или rotation refresh-токенов.
- **Проверка алгоритма (alg)** — убедитесь, что сервер не позволяет “alg: none” или не проверяет header неправильно (это иногда в старых/неправильных библиотеках было уязвимостью).
- **Хранение токена** — зависит от риска:
  - если хранится в LocalStorage / SessionStorage → риск XSS (скрипты на странице могут его украсть)
  - если в HttpOnly cookie → JavaScript не может прочитать, но может быть риск CSRF, если cookie автоматически отправляются с запросами без защиты.

---

## Проверенные источники и ссылки

- ИETF, RFC 7519 — официальный стандарт JWT.
- jwt.io — вводная информация, примеры, инструменты.
- Auth0, Descope и прочие ресурсы, объясняющие типичные claims и использование.
- Wikipedia — общее понятие, историческая справка.

---

Если хочешь, могу в таком же экранированном формате подготовить полностью завершённый текст “JWT — всё, что нужно знать на практике” + шаблон для React/Node.js?
:

---

> [!tip] Связанные темы
>
> - [Авторизация](/avtorizatsiya/avtorizatsiya)
> - [Cookie-сессия vs JWT](/avtorizatsiya/cookie-sessiya-vs-jwt)
> - [Vue](/vue)

